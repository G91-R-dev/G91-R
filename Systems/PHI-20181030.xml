<?xml version="1.0"?>

<system name="PHI">
    
    <property value="0.0">systems/gauges/PHI/doppler/switch</property>
    <property value="0.0">systems/gauges/PHI/doppler/switch-scanarea</property>
    <property value="0.0">systems/gauges/PHI/doppler/allarm</property>
    <property value="0.0">systems/gauges/PHI/doppler/sea-land</property>
    
    <property value="0.0">systems/gauges/PHI/control/sequence</property>
    <property value="0.0">systems/gauges/PHI/program/release-togle</property>
    
    <property value="0.0">systems/gauges/PHI/indicator/brg-imposed</property>
    <property value="0.0">systems/gauges/PHI/indicator/switch</property>
    <property value="0.0">systems/gauges/PHI/indicator/is-hold</property>
    <property value="0.0">systems/gauges/PHI/var-deg</property>
    <property value="0.0">systems/gauges/PHI/wind/wd</property>
    <property value="0.0">systems/gauges/PHI/wind/ws</property>
    <property value="80.0">systems/gauges/PHI/dir-div-1AW</property>
    <property value="10.0">systems/gauges/PHI/dir-div-2AW</property>
    <property value="0.0">systems/gauges/PHI/distance-reset</property>
    <property value="0.0">systems/gauges/PHI/wind/advise-light-set-on</property>
    <property value="45.0">systems/gauges/PHI/latitude</property>
    
    <property value="1.0">systems/gauges/PHI/program/route-from</property>
    <property value="1.0">systems/gauges/PHI/program/route-is-pusching</property>
    <property value="1.0">systems/gauges/PHI/program/route-pushed</property>
    <property value="20.0">systems/gauges/PHI/program/route[1]/dist</property>
    <property value="104.0">systems/gauges/PHI/program/route[1]/phi</property>
    <property value="0.0">systems/gauges/PHI/program/route[1]/push-pos</property>
    <property value="0.0">systems/gauges/PHI/program/route[1]/push-togle</property>
    <property value="20.0">systems/gauges/PHI/program/route[2]/dist</property>
    <property value="194.0">systems/gauges/PHI/program/route[2]/phi</property>
    <property value="0.0">systems/gauges/PHI/program/route[2]/push-pos</property>
    <property value="0.0">systems/gauges/PHI/program/route[2]/push-togle</property>
    <property value="40.0">systems/gauges/PHI/program/route[3]/dist</property>
    <property value="284.0">systems/gauges/PHI/program/route[3]/phi</property>
    <property value="0.0">systems/gauges/PHI/program/route[3]/push-pos</property>
    <property value="0.0">systems/gauges/PHI/program/route[3]/push-togle</property>
    <property value="20.0">systems/gauges/PHI/program/route[4]/dist</property>
    <property value="16.0">systems/gauges/PHI/program/route[4]/phi</property>
    <property value="0.0">systems/gauges/PHI/program/route[4]/push-pos</property>
    <property value="0.0">systems/gauges/PHI/program/route[4]/push-togle</property>
    <property value="20.0">systems/gauges/PHI/program/route[5]/dist</property>
    <property value="104.0">systems/gauges/PHI/program/route[5]/phi</property>
    <property value="0.0">systems/gauges/PHI/program/route[5]/push-pos</property>
    <property value="0.0">systems/gauges/PHI/program/route[5]/push-togle</property>
    
    
    <channel name="systems gauges PHI electric" execrate="32">
        
        <switch name="systems/gauges/PHI/operative">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/electric/bus[2]/PHI/fuse == 1
                systems/electric/bus[2]/V GE 24.0
            </test>
        </switch>
        
    </channel>
    
    
    <channel name="systems gauges PHI radar doppler" execrate="8">
        
        <switch name="systems/gauges/PHI/vtrue-fps-active">
            <default value="0"/>
            <test logic="AND" value="velocities/vtrue-fps">
                velocities/vtrue-kts GE 80.0
                gear/unit[0]/compression-ft LT 0.01
                systems/gauges/PHI/operative == 1
            </test>
        </switch>
        
        <sensor name="systems/gauges/PHI/radar-v-fts">
            <input>systems/gauges/PHI/vtrue-fps-active</input>
            <lag>0.0</lag>
            <noise variation="PERCENT" distribution="GAUSSIAN"> 0.01 </noise>
            <quantization name="name">
                <bits>12</bits>
                <min>0</min>
                <max>1000</max>
            </quantization>
            <drift_rate>0.0</drift_rate>
            <gain>1.0</gain>
            <bias>0.0</bias>
            <delay type="time">0.1</delay>
        </sensor>
        
        <integrator name="systems/gauges/PHI/radar-s-ft">
            <input>systems/gauges/PHI/radar-v-fts</input>
            <c1 type="ab2">1.0</c1>
            <trigger>systems/gauges/PHI/distance-reset</trigger>
        </integrator>
        
        <pure_gain name="systems/gauges/PHI/radar-s-mil">
            <input>systems/gauges/PHI/radar-s-ft</input>
            <gain>0.00018939393</gain>
        </pure_gain>
        
        <!-- Only for test -->
        
        <pure_gain name="systems/gauges/PHI/true-v-mil">
            <input>systems/gauges/PHI/radar-v-fts</input>
            <gain>0.68181696</gain>
        </pure_gain>
        
    </channel>
    
    
    <channel name="systems gauges PHI true distance" execrate="8">
        
        <!-- Attention only for test -->
        
        <switch name="systems/gauges/PHI/true-mil">
            <default value="0.0"/>
            <test logic="AND" value="systems/gauges/PHI/radar-s-mil">
                systems/gauges/PHI/operative == 1.0
            </test>
        </switch>
        
    </channel>
    
    
    <channel name="systems gauges PHI indicator digit" execrate="4">
        
        <switch name="systems/gauges/PHI/indicator/mil-sum">
            <default value="0.0"/>
            <test logic="AND" value="systems/gauges/PHI/radar-s-mil">
                systems/gauges/PHI/doppler/on == 1.0
            </test>
            <test logic="AND" value="systems/gauges/PHI/true-mil">
                systems/gauges/PHI/doppler/on == 0.0
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/distance-reset">
            <default value="systems/gauges/PHI/distance-reset"/>
            <test logic="AND" value="-1.0">
                systems/gauges/PHI/program/route-is-pusching == 1.0
            </test>
            <test logic="AND" value="0.0">
                systems/gauges/PHI/program/route-is-pusching == 0.0
            </test>
        </switch>
        
        <fcs_function name="systems/gauges/PHI/indicator/mil-digit">
            <function>
                <sum>
                    <product>
                        <p>systems/gauges/PHI/indicator/digit1A</p>
                        <v>100</v>
                    </product>
                    <product>
                        <p>systems/gauges/PHI/indicator/digit2A</p>
                        <v>10</v>
                    </product>
                    <p>systems/gauges/PHI/indicator/digit3A</p>
                </sum>
            </function>
        </fcs_function>

        <fcs_function name="systems/gauges/PHI/indicator/mil-direction">
            <function>
                <abs>
                    <difference>
                        <p>systems/gauges/PHI/indicator/dist</p>
                        <p>systems/gauges/PHI/indicator/mil-sum</p>
                    </difference>
                </abs>
            </function>
        </fcs_function>
        
        <fcs_function name="systems/gauges/PHI/indicator/digit-mil-dif">
            <function>
                <difference>
                    <integer>
                        <p>systems/gauges/PHI/indicator/mil-direction</p>
                    </integer>
                    <p>systems/gauges/PHI/indicator/mil-digit</p>
                </difference>
            </function>
        </fcs_function>
        
        <switch name="systems/gauges/PHI/indicator/digit-inc">
            <default value="systems/gauges/PHI/indicator/digit-inc"/>
            <test logic="AND" value="0.1">
                systems/gauges/PHI/indicator/digit-mil-dif GT 0.0
            </test>
            <test logic="AND" value="-0.1">
                systems/gauges/PHI/indicator/digit-mil-dif LT 0.0
            </test>
        </switch>
                
        <switch name="systems/gauges/PHI/program/route-from">
            <default value="systems/gauges/PHI/program/route-from"/>
            <test logic="AND" value="1.0">
                systems/gauges/PHI/indicator/digit-inc LE 0.0
            </test>
            <test logic="AND" value="0.0">
                systems/gauges/PHI/indicator/digit-inc GT 0.0
            </test>
        </switch>
        
        <fcs_function>
            <function>
                <integer>
                    <quotient>
                        <p>systems/gauges/PHI/indicator/mil-direction</p>
                        <v>100</v>
                    </quotient>
                </integer>
            </function>
            <output>systems/gauges/PHI/indicator/digit1A</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <integer>
                    <quotient>
                        <difference>
                            <p>systems/gauges/PHI/indicator/mil-direction</p>
                            <product>
                                <p>systems/gauges/PHI/indicator/digit1A</p>
                                <v>100</v>
                            </product>
                        </difference>
                        <v>10</v>
                    </quotient>
                </integer>
            </function>
            <output>systems/gauges/PHI/indicator/digit2A</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <integer>
                    <difference>
                        <p>systems/gauges/PHI/indicator/mil-direction</p>
                        <sum>
                            <product>
                                <p>systems/gauges/PHI/indicator/digit1A</p>
                                <v>100</v>
                            </product>
                            <product>
                                <p>systems/gauges/PHI/indicator/digit2A</p>
                                <v>10</v>
                            </product>
                        </sum>
                    </difference>
                </integer>
            </function>
            <output>systems/gauges/PHI/indicator/digit3A</output>
        </fcs_function>

        <fcs_function>
            <function>
                <ifthen>
                    <gt>
                        <abs>
                            <difference>
                                <p>systems/gauges/PHI/indicator/digit1A</p>
                                <p>systems/gauges/PHI/indicator/digit1AW</p>
                            </difference>
                        </abs>
                        <v>0.1</v>
                    </gt>
                    <p>systems/gauges/PHI/indicator/digit-inc</p>
                    <v>0.0</v>
                </ifthen>
            </function>
            <output>systems/gauges/PHI/indicator/digit1AW-inc</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <ifthen>
                    <gt>
                        <p>systems/gauges/PHI/indicator/digit1AW-inc</p>
                        <v>0.0</v>
                    </gt>
                    <ifthen>
                        <gt>
                            <p>systems/gauges/PHI/indicator/digit1AW</p>
                            <v>9.9</v>
                        </gt>
                        <v>0.0</v>
                        <sum>
                            <p>systems/gauges/PHI/indicator/digit1AW</p>
                            <p>systems/gauges/PHI/indicator/digit1AW-inc</p>
                        </sum>
                    </ifthen>
                    <ifthen>
                        <lt>
                            <p>systems/gauges/PHI/indicator/digit1AW</p>
                            <v>0.0</v>
                        </lt>
                        <v>9.9</v>
                        <sum>
                            <p>systems/gauges/PHI/indicator/digit1AW</p>
                            <p>systems/gauges/PHI/indicator/digit1AW-inc</p>
                        </sum>
                    </ifthen>
                </ifthen>
            </function>
            <output>systems/gauges/PHI/indicator/digit1AW</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <ifthen>
                    <gt>
                        <abs>
                            <difference>
                                <p>systems/gauges/PHI/indicator/digit2A</p>
                                <p>systems/gauges/PHI/indicator/digit2AW</p>
                            </difference>
                        </abs>
                        <v>0.1</v>
                    </gt>
                    <p>systems/gauges/PHI/indicator/digit-inc</p>
                    <v>0.0</v>
                </ifthen>
            </function>
            <output>systems/gauges/PHI/indicator/digit2AW-inc</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <ifthen>
                    <gt>
                        <p>systems/gauges/PHI/indicator/digit2AW-inc</p>
                        <v>0.0</v>
                    </gt>
                    <ifthen>
                        <gt>
                            <p>systems/gauges/PHI/indicator/digit2AW</p>
                            <v>9.9</v>
                        </gt>
                        <v>0.0</v>
                        <sum>
                            <p>systems/gauges/PHI/indicator/digit2AW</p>
                            <p>systems/gauges/PHI/indicator/digit2AW-inc</p>
                        </sum>
                    </ifthen>
                    <ifthen>
                        <lt>
                            <p>systems/gauges/PHI/indicator/digit2AW</p>
                            <v>0.0</v>
                        </lt>
                        <v>9.9</v>
                        <sum>
                            <p>systems/gauges/PHI/indicator/digit2AW</p>
                            <p>systems/gauges/PHI/indicator/digit2AW-inc</p>
                        </sum>
                    </ifthen>
                </ifthen>
            </function>
            <output>systems/gauges/PHI/indicator/digit2AW</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <ifthen>
                    <gt>
                        <abs>
                            <difference>
                                <p>systems/gauges/PHI/indicator/digit3A</p>
                                <p>systems/gauges/PHI/indicator/digit3AW</p>
                            </difference>
                        </abs>
                        <v>0.1</v>
                    </gt>
                    <p>systems/gauges/PHI/indicator/digit-inc</p>
                    <v>0.0</v>
                </ifthen>
            </function>
            <output>systems/gauges/PHI/indicator/digit3AW-inc</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <ifthen>
                    <gt>
                        <p>systems/gauges/PHI/indicator/digit3AW-inc</p>
                        <v>0.0</v>
                    </gt>
                    <ifthen>
                        <gt>
                            <p>systems/gauges/PHI/indicator/digit3AW</p>
                            <v>9.9</v>
                        </gt>
                        <v>0.0</v>
                        <sum>
                            <p>systems/gauges/PHI/indicator/digit3AW</p>
                            <p>systems/gauges/PHI/indicator/digit3AW-inc</p>
                        </sum>
                    </ifthen>
                    <ifthen>
                        <lt>
                            <p>systems/gauges/PHI/indicator/digit3AW</p>
                            <v>0.0</v>
                        </lt>
                        <v>9.9</v>
                        <sum>
                            <p>systems/gauges/PHI/indicator/digit3AW</p>
                            <p>systems/gauges/PHI/indicator/digit3AW-inc</p>
                        </sum>
                    </ifthen>
                </ifthen>
            </function>
            <output>systems/gauges/PHI/indicator/digit3AW</output>
        </fcs_function>
        
    </channel>

    
    <channel name="systems gauges PHI wind digit" execrate="4">
        
        <fcs_function name="systems/gauges/PHI/wind/digit-ws-dif">
            <function>
                <difference>
                    <integer>
                        <p>systems/gauges/PHI/wind/ws</p>
                    </integer>
                    <sum>
                        <product>
                            <p>systems/gauges/PHI/wind/digit1A</p>
                            <v>100</v>
                        </product>
                        <product>
                            <p>systems/gauges/PHI/wind/digit2A</p>
                            <v>10</v>
                        </product>
                        <p>systems/gauges/PHI/wind/digit3A</p>
                    </sum>
                </difference>
            </function>
        </fcs_function>
        
        <switch name="systems/gauges/PHI/wind/digit-inc">
            <default value="systems/gauges/PHI/wind/digit-inc"/>
            <test logic="AND" value="0.1">
                systems/gauges/PHI/wind/digit-ws-dif GT 0.0
            </test>
            <test logic="AND" value="-0.1">
                systems/gauges/PHI/wind/digit-ws-dif LT 0.0
            </test>
        </switch>
        
        <fcs_function>
            <function>
                <integer>
                    <quotient>
                        <p>systems/gauges/PHI/wind/ws</p>
                        <v>100</v>
                    </quotient>
                </integer>
            </function>
            <output>systems/gauges/PHI/wind/digit1A</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <integer>
                    <quotient>
                        <difference>
                            <p>systems/gauges/PHI/wind/ws</p>
                            <product>
                                <p>systems/gauges/PHI/wind/digit1A</p>
                                <v>100</v>
                            </product>
                        </difference>
                        <v>10</v>
                    </quotient>
                </integer>
            </function>
            <output>systems/gauges/PHI/wind/digit2A</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <integer>
                    <difference>
                        <p>systems/gauges/PHI/wind/ws</p>
                        <sum>
                            <product>
                                <p>systems/gauges/PHI/wind/digit1A</p>
                                <v>100</v>
                            </product>
                            <product>
                                <p>systems/gauges/PHI/wind/digit2A</p>
                                <v>10</v>
                            </product>
                        </sum>
                    </difference>
                </integer>
            </function>
            <output>systems/gauges/PHI/wind/digit3A</output>
        </fcs_function>

        <fcs_function>
            <function>
                <ifthen>
                    <gt>
                        <abs>
                            <difference>
                                <p>systems/gauges/PHI/wind/digit1A</p>
                                <p>systems/gauges/PHI/wind/digit1AW</p>
                            </difference>
                        </abs>
                        <v>0.1</v>
                    </gt>
                    <p>systems/gauges/PHI/wind/digit-inc</p>
                    <v>0.0</v>
                </ifthen>
            </function>
            <output>systems/gauges/PHI/wind/digit1AW-inc</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <ifthen>
                    <gt>
                        <p>systems/gauges/PHI/wind/digit1AW-inc</p>
                        <v>0.0</v>
                    </gt>
                    <ifthen>
                        <gt>
                            <p>systems/gauges/PHI/wind/digit1AW</p>
                            <v>9.9</v>
                        </gt>
                        <v>0.0</v>
                        <sum>
                            <p>systems/gauges/PHI/wind/digit1AW</p>
                            <p>systems/gauges/PHI/wind/digit1AW-inc</p>
                        </sum>
                    </ifthen>
                    <ifthen>
                        <lt>
                            <p>systems/gauges/PHI/wind/digit1AW</p>
                            <v>0.0</v>
                        </lt>
                        <v>9.9</v>
                        <sum>
                            <p>systems/gauges/PHI/wind/digit1AW</p>
                            <p>systems/gauges/PHI/wind/digit1AW-inc</p>
                        </sum>
                    </ifthen>
                </ifthen>
            </function>
            <output>systems/gauges/PHI/wind/digit1AW</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <ifthen>
                    <gt>
                        <abs>
                            <difference>
                                <p>systems/gauges/PHI/wind/digit2A</p>
                                <p>systems/gauges/PHI/wind/digit2AW</p>
                            </difference>
                        </abs>
                        <v>0.1</v>
                    </gt>
                    <p>systems/gauges/PHI/wind/digit-inc</p>
                    <v>0.0</v>
                </ifthen>
            </function>
            <output>systems/gauges/PHI/wind/digit2AW-inc</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <ifthen>
                    <gt>
                        <p>systems/gauges/PHI/wind/digit2AW-inc</p>
                        <v>0.0</v>
                    </gt>
                    <ifthen>
                        <gt>
                            <p>systems/gauges/PHI/wind/digit2AW</p>
                            <v>9.9</v>
                        </gt>
                        <v>0.0</v>
                        <sum>
                            <p>systems/gauges/PHI/wind/digit2AW</p>
                            <p>systems/gauges/PHI/wind/digit2AW-inc</p>
                        </sum>
                    </ifthen>
                    <ifthen>
                        <lt>
                            <p>systems/gauges/PHI/wind/digit2AW</p>
                            <v>0.0</v>
                        </lt>
                        <v>9.9</v>
                        <sum>
                            <p>systems/gauges/PHI/wind/digit2AW</p>
                            <p>systems/gauges/PHI/wind/digit2AW-inc</p>
                        </sum>
                    </ifthen>
                </ifthen>
            </function>
            <output>systems/gauges/PHI/wind/digit2AW</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <ifthen>
                    <gt>
                        <abs>
                            <difference>
                                <p>systems/gauges/PHI/wind/digit3A</p>
                                <p>systems/gauges/PHI/wind/digit3AW</p>
                            </difference>
                        </abs>
                        <v>0.1</v>
                    </gt>
                    <p>systems/gauges/PHI/wind/digit-inc</p>
                    <v>0.0</v>
                </ifthen>
            </function>
            <output>systems/gauges/PHI/wind/digit3AW-inc</output>
        </fcs_function>
        
        <fcs_function>
            <function>
                <ifthen>
                    <gt>
                        <p>systems/gauges/PHI/wind/digit3AW-inc</p>
                        <v>0.0</v>
                    </gt>
                    <ifthen>
                        <gt>
                            <p>systems/gauges/PHI/wind/digit3AW</p>
                            <v>9.9</v>
                        </gt>
                        <v>0.0</v>
                        <sum>
                            <p>systems/gauges/PHI/wind/digit3AW</p>
                            <p>systems/gauges/PHI/wind/digit3AW-inc</p>
                        </sum>
                    </ifthen>
                    <ifthen>
                        <lt>
                            <p>systems/gauges/PHI/wind/digit3AW</p>
                            <v>0.0</v>
                        </lt>
                        <v>9.9</v>
                        <sum>
                            <p>systems/gauges/PHI/wind/digit3AW</p>
                            <p>systems/gauges/PHI/wind/digit3AW-inc</p>
                        </sum>
                    </ifthen>
                </ifthen>
            </function>
            <output>systems/gauges/PHI/wind/digit3AW</output>
        </fcs_function>

    </channel>
    
    
    <channel name="systems gauges PHI wind sequence light" execrate="16">
        
        <pid name="systems/gauges/PHI/wind/advise-light-wd">
            <input>systems/gauges/PHI/wind/wd</input>
            <kp>0.0</kp>
            <ki>0.0</ki>
            <kd>1.0</kd>
        </pid>
        
        <pid name="systems/gauges/PHI/wind/advise-light-ws">
            <input>systems/gauges/PHI/wind/ws</input>
            <kp>0.0</kp>
            <ki>0.0</ki>
            <kd>1.0</kd>
        </pid>
        
        <pid name="systems/gauges/PHI/wind/advise-light-phi">
            <input>systems/gauges/PHI/indicator/is-phi-on</input>
            <kp>0.0</kp>
            <ki>0.0</ki>
            <kd>1.0</kd>
        </pid>
        
        <pid name="systems/gauges/PHI/wind/advise-light-phi-rel">
            <input>systems/gauges/PHI/program/release-on</input>
            <kp>0.0</kp>
            <ki>0.0</ki>
            <kd>1.0</kd>
        </pid>
        
        <fcs_function name="systems/gauges/PHI/wind/advise-light-ws-wd-phi-rel">
            <function>
                <sum>
                    <ifthen>
                        <p>systems/gauges/PHI/indicator/is-phi-on</p>
                        <p>systems/gauges/PHI/wind/advise-light-phi</p>
                        <v>0.0</v>
                    </ifthen>
                    <ifthen>
                        <nq>
                            <p>systems/gauges/PHI/program/release-on</p>
                            <v>1</v>
                        </nq>
                        <p>systems/gauges/PHI/wind/advise-light-phi-rel</p>
                        <v>0.0</v>
                    </ifthen>
                    <p>systems/gauges/PHI/wind/advise-light-ws</p>
                    <p>systems/gauges/PHI/wind/advise-light-wd</p>
                </sum>
            </function>
        </fcs_function>
        
        <lag_filter name="systems/gauges/PHI/wind/advise-light-set-prepare-on">
            <input>systems/gauges/PHI/wind/advise-light-ws-wd-phi-rel</input>
            <c1>2.0</c1>
        </lag_filter>
        
        <lag_filter name="systems/gauges/PHI/wind/advise-light-set-on">
            <input>systems/gauges/PHI/wind/advise-light-set-prepare-on</input>
            <c1>0.1</c1>
        </lag_filter>
        
        
        <switch name="systems/gauges/PHI/wind/advise-light-transparent">
            <default value="0.85"/>
            <test logic="AND" value="systems/warning-lights/transparent-by-bus2-tension">
                <test logic="OR">
                    systems/gauges/PHI/wind/advise-light-set-on GT 0.1
                    systems/gauges/PHI/wind/advise-light-set-on LT -0.1
                </test>
                <test logic="AND">
                    systems/gauges/PHI/wind/advise-light-set-prepare-on GT -0.1
                    systems/gauges/PHI/wind/advise-light-set-prepare-on LT 0.1
                </test>
            </test>
        </switch>
        
        
        <switch name="systems/gauges/PHI/wind/advise-light-on">
            <default value="0.0"/>
            <test logic="AND" value="systems/warning-lights/light-intensity-by-bus2-tension">
                <test logic="OR">
                    systems/gauges/PHI/wind/advise-light-set-on GT 0.1
                    systems/gauges/PHI/wind/advise-light-set-on LT -0.1
                </test>
                <test logic="AND">
                    systems/gauges/PHI/wind/advise-light-set-prepare-on GT -0.1
                    systems/gauges/PHI/wind/advise-light-set-prepare-on LT 0.1
                </test>
            </test>
        </switch>
        
    </channel>
    
    
    <channel name="systems gauges PHI wind correction" execrate="16">
        
        <fcs_function name="systems/gauges/PHI/wind/correction-wind-speed">
            <function>
                <ifthen>
                    <and>
                        <p>systems/gauges/PHI/indicator/is-phi-on</p>
                        <lt>
                            <p>systems/gauges/PHI/wind/advise-light-set-on</p>
                            <v>0.1</v>
                        </lt>
                    </and>
                    <product>
                        <p>systems/gauges/PHI/wind/ws</p>
                        <cos>
                            <toradians>
                                <difference>
                                    <p>systems/gauges/PHI/program/route-phi</p>
                                    <p>systems/gauges/PHI/wind/wd</p>
                                </difference>
                            </toradians>
                        </cos>
                    </product>
                    <v>0.0</v>
                </ifthen>
            </function>
        </fcs_function>
    
        <fcs_function name="systems/gauges/PHI/wind/correction-wind-dir">
            <function>
                <ifthen>
                    <and>
                        <p>systems/gauges/PHI/indicator/is-phi-on</p>
                        <gt>
                            <p>systems/gauges/PHI/true-v-mil</p>
                            <v>80.0</v>
                        </gt>
                        <lt>
                            <p>systems/gauges/PHI/wind/advise-light-set-on</p>
                            <v>0.1</v>
                        </lt>
                    </and>
                    <todegrees>
                        <atan>
                            <quotient>
                                <product>
                                    <p>systems/gauges/PHI/wind/ws</p>
                                    <sin>
                                        <toradians>
                                            <difference>
                                                <p>systems/gauges/PHI/program/route-phi</p>
                                                <p>systems/gauges/PHI/wind/wd</p>
                                            </difference>
                                        </toradians>
                                    </sin>
                                </product>
                                <p>systems/gauges/PHI/true-v-mil</p>
                            </quotient>
                        </atan>
                    </todegrees>
                    <v>0.0</v>
                </ifthen>
            </function>
        </fcs_function>
        
    </channel>
    
    
    <channel name="systems gauges PHI select route" execrate="16">
        
        <washout_filter name="systems/gauges/PHI/program/route[1]/push-togle-washed">
            <input>systems/gauges/PHI/program/route[1]/push-togle</input>
            <c1>4.0</c1>
        </washout_filter>
        
        <switch name="systems/gauges/PHI/program/route[1]/push-togle-norm">
            <default value="systems/gauges/PHI/program/route[1]/push-togle-norm"/>
            <test logic="AND" value = "1">
                <test logic="OR">
                    systems/gauges/PHI/program/route[1]/push-togle-washed GT 0.1
                    systems/gauges/PHI/program/route[1]/push-togle-washed LT -0.1
                </test>
                systems/gauges/PHI/program/route-is-pusching == 0
            </test>
            <test logic="AND" value = "0">
                systems/gauges/PHI/program/route-is-pusching == 1
            </test>
        </switch>
        
        <lag_filter name="systems/gauges/PHI/program/route[1]/push-pos-lag">
            <input>systems/gauges/PHI/program/route[1]/push-togle-norm</input>
            <c1>32</c1>
        </lag_filter>
        
        <switch name="systems/gauges/PHI/program/route[1]/push-light-on">
            <default value="0.0"/>
            <test logic="AND" value = "systems/gauges/PHI/program/light-intensity-by-bus2-tension-on-caddy">
                systems/gauges/PHI/program/route-pushed == 1
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/program/route[1]/push-light-on-transparent">
            <default value="0.5"/>
            <test logic="AND" value = "systems/gauges/PHI/program/transparent-by-bus2-tension-on-caddy">
                systems/gauges/PHI/program/route-pushed == 1
            </test>
        </switch>
        
        <washout_filter name="systems/gauges/PHI/program/route[2]/push-togle-washed">
            <input>systems/gauges/PHI/program/route[2]/push-togle</input>
            <c1>4.0</c1>
        </washout_filter>
        
        <switch name="systems/gauges/PHI/program/route[2]/push-togle-norm">
            <default value="systems/gauges/PHI/program/route[2]/push-togle-norm"/>
            <test logic="AND" value = "1">
                <test logic="OR">
                    systems/gauges/PHI/program/route[2]/push-togle-washed GT 0.1
                    systems/gauges/PHI/program/route[2]/push-togle-washed LT -0.1
                </test>
                systems/gauges/PHI/program/route-is-pusching == 0
            </test>
            <test logic="AND" value = "0">
                systems/gauges/PHI/program/route-is-pusching == 1
            </test>
        </switch>
        
        <lag_filter name="systems/gauges/PHI/program/route[2]/push-pos-lag">
            <input>systems/gauges/PHI/program/route[2]/push-togle-norm</input>
            <c1>32</c1>
        </lag_filter>
        
        <switch name="systems/gauges/PHI/program/route[2]/push-light-on">
            <default value="0.0"/>
            <test logic="AND" value = "systems/gauges/PHI/program/light-intensity-by-bus2-tension-on-caddy">
                systems/gauges/PHI/program/route-pushed == 2
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/program/route[2]/push-light-on-transparent">
            <default value="0.5"/>
            <test logic="AND" value = "systems/gauges/PHI/program/transparent-by-bus2-tension-on-caddy">
                systems/gauges/PHI/program/route-pushed == 2
            </test>
        </switch>
        
        <washout_filter name="systems/gauges/PHI/program/route[3]/push-togle-washed">
            <input>systems/gauges/PHI/program/route[3]/push-togle</input>
            <c1>4.0</c1>
        </washout_filter>
        
        <switch name="systems/gauges/PHI/program/route[3]/push-togle-norm">
            <default value="systems/gauges/PHI/program/route[3]/push-togle-norm"/>
            <test logic="AND" value = "1">
                <test logic="OR">
                    systems/gauges/PHI/program/route[3]/push-togle-washed GT 0.1
                    systems/gauges/PHI/program/route[3]/push-togle-washed LT -0.1
                </test>
                systems/gauges/PHI/program/route-is-pusching == 0
            </test>
            <test logic="AND" value = "0">
                systems/gauges/PHI/program/route-is-pusching == 1
            </test>
        </switch>
        
        <lag_filter name="systems/gauges/PHI/program/route[3]/push-pos-lag">
            <input>systems/gauges/PHI/program/route[3]/push-togle-norm</input>
            <c1>32</c1>
        </lag_filter>
        
        <switch name="systems/gauges/PHI/program/route[3]/push-light-on">
            <default value="0.0"/>
            <test logic="AND" value = "systems/gauges/PHI/program/light-intensity-by-bus2-tension-on-caddy">
                systems/gauges/PHI/program/route-pushed == 3
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/program/route[3]/push-light-on-transparent">
            <default value="0.5"/>
            <test logic="AND" value = "systems/gauges/PHI/program/transparent-by-bus2-tension-on-caddy">
                systems/gauges/PHI/program/route-pushed == 3
            </test>
        </switch>
        
        <washout_filter name="systems/gauges/PHI/program/route[4]/push-togle-washed">
            <input>systems/gauges/PHI/program/route[4]/push-togle</input>
            <c1>4.0</c1>
        </washout_filter>
        
        <switch name="systems/gauges/PHI/program/route[4]/push-togle-norm">
            <default value="systems/gauges/PHI/program/route[4]/push-togle-norm"/>
            <test logic="AND" value = "1">
                <test logic="OR">
                    systems/gauges/PHI/program/route[4]/push-togle-washed GT 0.1
                    systems/gauges/PHI/program/route[4]/push-togle-washed LT -0.1
                </test>
                systems/gauges/PHI/program/route-is-pusching == 0
            </test>
            <test logic="AND" value = "0">
                systems/gauges/PHI/program/route-is-pusching == 1
            </test>
        </switch>
        
        <lag_filter name="systems/gauges/PHI/program/route[4]/push-pos-lag">
            <input>systems/gauges/PHI/program/route[4]/push-togle-norm</input>
            <c1>32</c1>
        </lag_filter>
        
        <switch name="systems/gauges/PHI/program/route[4]/push-light-on">
            <default value="0.0"/>
            <test logic="AND" value = "systems/gauges/PHI/program/light-intensity-by-bus2-tension-on-caddy">
                systems/gauges/PHI/program/route-pushed == 4
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/program/route[4]/push-light-on-transparent">
            <default value="0.5"/>
            <test logic="AND" value = "systems/gauges/PHI/program/transparent-by-bus2-tension-on-caddy">
                systems/gauges/PHI/program/route-pushed == 4
            </test>
        </switch>
        
        <washout_filter name="systems/gauges/PHI/program/route[5]/push-togle-washed">
            <input>systems/gauges/PHI/program/route[5]/push-togle</input>
            <c1>4.0</c1>
        </washout_filter>
        
        <switch name="systems/gauges/PHI/program/route[5]/push-togle-norm">
            <default value="systems/gauges/PHI/program/route[5]/push-togle-norm"/>
            <test logic="AND" value = "1">
                <test logic="OR">
                    systems/gauges/PHI/program/route[5]/push-togle-washed GT 0.1
                    systems/gauges/PHI/program/route[5]/push-togle-washed LT -0.1
                </test>
                systems/gauges/PHI/program/route-is-pusching == 0
            </test>
            <test logic="AND" value = "0">
                systems/gauges/PHI/program/route-is-pusching == 1
            </test>
        </switch>
        
        <lag_filter name="systems/gauges/PHI/program/route[5]/push-pos-lag">
            <input>systems/gauges/PHI/program/route[5]/push-togle-norm</input>
            <c1>32</c1>
        </lag_filter>
        
        <switch name="systems/gauges/PHI/program/route[5]/push-light-on">
            <default value="0.0"/>
            <test logic="AND" value = "systems/gauges/PHI/program/light-intensity-by-bus2-tension-on-caddy">
                systems/gauges/PHI/program/route-pushed == 5
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/program/route[5]/push-light-on-transparent">
            <default value="0.5"/>
            <test logic="AND" value = "systems/gauges/PHI/program/transparent-by-bus2-tension-on-caddy">
                systems/gauges/PHI/program/route-pushed == 5
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/program/route-is-pusching">
            <default value="0.0"/>
            <test logic="OR" value="1.0">
                <test logic="AND">
                    systems/gauges/PHI/program/route[1]/push-pos-lag GE 0.1
                    systems/gauges/PHI/program/route[1]/push-pos-lag LT 0.8
                </test>
                <test logic="AND">
                    systems/gauges/PHI/program/route[2]/push-pos-lag GE 0.1
                    systems/gauges/PHI/program/route[2]/push-pos-lag LT 0.8
                </test>
                <test logic="AND">
                    systems/gauges/PHI/program/route[3]/push-pos-lag GE 0.1
                    systems/gauges/PHI/program/route[3]/push-pos-lag LT 0.8
                </test>
                <test logic="AND">
                    systems/gauges/PHI/program/route[4]/push-pos-lag GE 0.1
                    systems/gauges/PHI/program/route[4]/push-pos-lag LT 0.8
                </test>
                <test logic="AND">
                    systems/gauges/PHI/program/route[5]/push-pos-lag GE 0.1
                    systems/gauges/PHI/program/route[5]/push-pos-lag LT 0.8
                </test>
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/program/route-pushed">
            <default value="0"/>
            <test logic="AND" value="0.0">
                systems/gauges/PHI/program/release-on == 1
            </test>
            <test logic="AND" value="1.0">
                systems/gauges/PHI/program/route[1]/push-pos-lag GE 0.9
            </test>
            <test logic="AND" value="2.0">
                systems/gauges/PHI/program/route[2]/push-pos-lag GE 0.9
            </test>
            <test logic="AND" value="3.0">
                systems/gauges/PHI/program/route[3]/push-pos-lag GE 0.9
            </test>
            <test logic="AND" value="4.0">
                systems/gauges/PHI/program/route[4]/push-pos-lag GE 0.9
            </test>
            <test logic="AND" value="5.0">
                systems/gauges/PHI/program/route[5]/push-pos-lag GE 0.9
            </test>
        </switch>
        
    </channel>    
    
    
    <channel name="systems gauges PHI indicator brg" execrate="16">
        
        <fcs_function name="systems/gauges/PHI/program/route-phi">
            <function>
                <ifthen>
                    <p>systems/gauges/PHI/indicator/is-phi-on</p>
                    <switch>
                        <p>systems/gauges/PHI/program/route-pushed</p>
                        <v>0</v>
                        <p>systems/gauges/PHI/program/route[1]/phi</p>
                        <p>systems/gauges/PHI/program/route[2]/phi</p>
                        <p>systems/gauges/PHI/program/route[3]/phi</p>
                        <p>systems/gauges/PHI/program/route[4]/phi</p>
                        <p>systems/gauges/PHI/program/route[5]/phi</p>
                    </switch>
                    <v>0.0</v>
                </ifthen>
            </function>
        </fcs_function>
        
        <fcs_function name="systems/gauges/PHI/indicator/brg">
            <function>
                <sum>
                    <ifthen>
                        <p>systems/gauges/PHI/indicator/is-phi-on</p>
                        <ifthen>
                            <or>
                                <eq>
                                    <p>systems/gauges/PHI/program/route-pushed</p>
                                    <v>0.0</v>
                                </eq>
                                <p>systems/gauges/PHI/program/route-from</p>
                            </or>
                            <v>0.0</v>
                            <v>180.0</v>
                        </ifthen>
                        <v>0.0</v>
                    </ifthen>
                    <ifthen>
                        <and>
                            <p>systems/gauges/PHI/operative</p>
                            <not>
                                <p>systems/gauges/PHI/indicator/is-hold-on</p>
                            </not>
                        </and>
                        <ifthen>
                            <p>systems/gauges/PHI/indicator/is-ps-on</p>
                            <p>systems/gauges/PHI/indicator/brg-imposed</p>
                            <ifthen>
                                <p>systems/gauges/PHI/indicator/is-phi-on</p>
                                <sum>
                                    <p>systems/gauges/PHI/wind/correction-wind-dir</p>
                                    <difference>
                                        <p>systems/gauges/PHI/program/route-phi</p>
                                        <p>systems/gauges/PHI/attitude/heading-true-deg</p>
                                    </difference>
                                </sum>
                                <v>0.0</v>
                            </ifthen>
                        </ifthen>
                        <v>0.0</v>
                    </ifthen>
                </sum>
            </function>
        </fcs_function>
        
        <lag_filter name="systems/gauges/PHI/indicator/brg-lag">
            <input>systems/gauges/PHI/indicator/brg</input>
            <c1>2.0</c1>
        </lag_filter>
        
    </channel>
    
    
    <channel name="systems gauges PHI indicator dist" execrate="16">
        
        <fcs_function name="systems/gauges/PHI/indicator/dist">
            <function>
                <ifthen>
                    <and>
                        <p>systems/gauges/PHI/operative</p>
                        <p>systems/gauges/PHI/indicator/is-phi-on</p>
                    </and>
                    <switch>
                        <p>systems/gauges/PHI/program/route-pushed</p>
                        <v>0</v>
                        <p>systems/gauges/PHI/program/route[1]/dist</p>
                        <p>systems/gauges/PHI/program/route[2]/dist</p>
                        <p>systems/gauges/PHI/program/route[3]/dist</p>
                        <p>systems/gauges/PHI/program/route[4]/dist</p>
                        <p>systems/gauges/PHI/program/route[5]/dist</p>
                    </switch>
                    <v>0.0</v>
                </ifthen>
            </function>
        </fcs_function>
        
    </channel>
    
    
    <channel name="systems gauges PHI indicator switch" execrate="16">
        
        <lag_filter name="systems/gauges/PHI/indicator/switch-lag">
            <input>systems/gauges/PHI/indicator/switch</input>
            <c1>2.0</c1>
        </lag_filter>
        
        <switch name="systems/gauges/PHI/indicator/is-hold-on">
            <default value="0.0"/>
            <test logic="AND" value="1.0">
                systems/gauges/PHI/indicator/switch-lag LT -0.9
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/indicator/is-phi-on">
            <default value="0.0"/>
            <test logic="AND" value="1.0">
                systems/gauges/PHI/indicator/switch-lag GT -0.2
                systems/gauges/PHI/indicator/switch-lag LT 0.2
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/indicator/is-ps-on">
            <default value="0.0"/>
            <test logic="AND" value="1.0">
                systems/gauges/PHI/indicator/switch-lag GT 0.9
            </test>
        </switch>

    </channel>
    
        
    <channel name="systems gauges PHI attitude" execrate="4">
        
        <fcs_function name="systems/gauges/PHI/attitude/heading-true-deg">
            <function>
                <ifthen>
                    <p>systems/gauges/PHI/operative</p>
                    <difference>
                        <product>
                            <p>attitude/heading-true-rad</p>
                            <v>57.2958</v>
                        </product>
                        <p>systems/gauges/PHI/var-deg</p>
                    </difference>
                    <v>0.0</v>
                </ifthen>
            </function>
            <output>systems/airbrake/sound-roumble</output>
        </fcs_function>
        
        <lag_filter name="systems/gauges/PHI/attitude/heading-true-deg-lag">
            <input>systems/gauges/PHI/attitude/heading-true-deg</input>
            <c1>32</c1>
        </lag_filter>
        
    </channel>
    
    
    <channel name="systems gauges PHI doppler pannel switch" execrate="16">
        
        <lag_filter name="systems/gauges/PHI/doppler/switch-lag">
            <input>systems/gauges/PHI/doppler/switch</input>
            <c1>2.0</c1>
        </lag_filter>
        
        <switch name="systems/gauges/PHI/doppler/off">
            <default value="0.0"/>
            <test logic="AND" value="1.0">
                systems/gauges/PHI/doppler/switch-lag LT -0.9
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/doppler/rec-only">
            <default value="0.0"/>
            <test logic="AND" value="1.0">
                systems/gauges/PHI/doppler/switch-lag GT -0.2
                systems/gauges/PHI/doppler/switch-lag LT 0.2
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/doppler/on">
            <default value="0.0"/>
            <test logic="AND" value="1.0">
                systems/gauges/PHI/doppler/switch-lag GT 0.9
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/doppler/test">
            <default value="0.0"/>
            <test logic="AND" value="1.0">
                systems/gauges/PHI/doppler/switch-lag GT 1.8
            </test>
        </switch>
        
    </channel>
    
    
    <channel name="systems gauges PHI release caddy" execrate="16">
        
        <washout_filter name="systems/gauges/PHI/program/release-togle-washed">
            <input>systems/gauges/PHI/program/release-togle</input>
            <c1>4.0</c1>
        </washout_filter>
        
        <switch name="systems/gauges/PHI/program/release-togle-washed-norm">
            <default value="0.0"/>
            <test logic="OR" value="1">
                systems/gauges/PHI/program/release-togle-washed GT 0.1
                systems/gauges/PHI/program/release-togle-washed LT -0.1
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/program/release-on-start">
            <default value="systems/gauges/PHI/program/release-on-start"/>
            <test logic="AND" value = "1">
                systems/gauges/PHI/program/release-togle-washed-norm == 1
                systems/gauges/PHI/program/release-togle-pos-lag LT 0.01
            </test>
            <test logic="AND" value = "0">
                systems/gauges/PHI/program/release-togle-washed-norm == 1
                systems/gauges/PHI/program/release-togle-pos-lag GT 0.3
            </test>
        </switch>
        
        <lag_filter name="systems/gauges/PHI/program/release-togle-pos-lag">
            <input>systems/gauges/PHI/program/release-on-start</input>
            <c1>1</c1>
        </lag_filter>
        
        <switch name="systems/gauges/PHI/program/release-on">
            <default value="0.0"/>
            <test logic="AND" value="0">
                systems/gauges/PHI/program/release-togle-pos-lag LE 0.05
            </test>
            <test logic="AND" value="1">
                systems/gauges/PHI/program/release-togle-pos-lag GT 0.05
            </test>
        </switch>
        
        <fcs_function name="systems/gauges/PHI/program/light-intensity-by-bus2-tension-on-caddy">
            <function>
                <ifthen>
                    <eq>
                        <p>systems/gauges/PHI/program/release-on</p>
                        <v>0.0</v>
                    </eq>
                    <product>
                        <p>systems/warning-lights/light-intensity-by-bus2-tension</p>
                        <p>systems/lightning/ambient-light-emission-display-correction</p>
                        <v>2.0</v>
                    </product>
                    <v>0.0</v>
                </ifthen>
            </function>
            <clipto>
                <min>0.0</min>
                <max>1.0</max>
            </clipto>]
        </fcs_function>
        
        <switch name="systems/gauges/PHI/program/transparent-by-bus2-tension-on-caddy">
            <default value="0.0"/>
            <test logic="AND" value = "systems/warning-lights/transparent-by-bus2-tension">
                systems/gauges/PHI/program/release-on == 0
            </test>
        </switch>
        
        <switch name="systems/gauges/PHI/program/gauge_phosphorescent_light-on-caddy">
            <default value="0.0"/>
            <test logic="AND" value = "/sim/G91/re_emit/gauge_phosphorescent_light">
                systems/gauges/PHI/program/release-on == 0
            </test>
        </switch>
        
    </channel>
    
</system>
