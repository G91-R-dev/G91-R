<?xml version="1.0"?> 

<!--

The C1 lag_filter is less is longer respond time

-->

<system name="Gauges">  
    
    <property value="0">systems/gauges/cockpit-attitude-J8-horizon-offset</property>
    <property value="0">systems/gauges/cockpit-attitude-J8-caged-push-trigger</property>
    
    <channel name="Cockpit Fuel Pounds" execrate="8">
        
        <summer name="systems/gauges/cockpit-fuel-pounds/fuel_pounds_0-1-2">
            <input>propulsion/tank[0]/contents-lbs</input>
            <input>propulsion/tank[1]/contents-lbs</input>
            <input>propulsion/tank[2]/contents-lbs</input>
        </summer>
        
        <pure_gain name="propulsion/tank[5]/contents-lbs-27">
            <input>propulsion/tank[5]/contents-lbs</input>
            <gain>2.7</gain>
        </pure_gain>
        
        <switch name="systems/gauges/cockpit-fuel-pounds/libs">
            <default value="0"/>
            <test logic="AND" value="systems/gauges/cockpit-fuel-pounds/fuel_pounds_0-1-2">
                systems/electric/bus[1]/V GE 18.0
                systems/electric/bus[1]/fuel-level-indicator/sw == 0
            </test>
            <test logic="AND" value="propulsion/tank[5]/contents-lbs-27">
                systems/electric/bus[1]/V GE 18.0
                systems/electric/bus[1]/fuel-level-indicator/sw == 1
            </test>
        </switch>
        
        <lag_filter name="systems/gauges/cockpit-fuel-pounds/display-libs">
            <input>systems/gauges/cockpit-fuel-pounds/libs</input>
            <c1>2.0</c1>
        </lag_filter>
        
    </channel>
    
    
    <channel name="Cockpit Gyroscopic Turn Indicator" execrate="8">
        
        <!--
        the "Cockpit Gyroscopic Turn Indicator" is a gauge that has a gyroscope at the inside and allows
        to obtain the rotation speed of the plane on the Z axis ("velocities / r-aero-rad_sec").
        The instrument has an electric motor powered by a BUS [1] which must have a voltage of at least 12V.
        When turning on, the gyroscope turns more slowly and therefore the settling time is longer.
        The lengthening of the settling time is simulated (even if in a physically inaccurate way)
        by the reduction of the reaction time by low pass filter:
        <lag_filter name = "systems/gauges/cockpit-turn-indicator/rad-sec">
        the parameter C1 of the filter is modified run-time by the low pass filter:
        <lag_filter name = "systems/gauges/cockpit-turn-indicator/gyro-sensibility">
        which describes the inertia of the gyro in both switch-on and switch-off.
        This means that if the voltage is turned off, the instrument works for a time run of about thirty seconds
        and then stops go o the center.
        -->
        
        <switch name="systems/gauges/cockpit-turn-indicator/operative">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/electric/inv-primary/V GT 110.0
                systems/electric/bus[1]/turn-indicator/fuse == 1
            </test>
        </switch>
        
        <switch name="systems/gauges/cockpit-turn-indicator/gyro-start-stop">
            <default value="0.01"/>
            <test logic="AND" value="0.5">
                systems/gauges/cockpit-turn-indicator/operative == 1
            </test>
        </switch>
        
        <lag_filter name="systems/gauges/cockpit-turn-indicator/gyro-sensibility">
            <input>systems/gauges/cockpit-turn-indicator/gyro-start-stop</input>
            <c1>0.1</c1>
        </lag_filter>
        
        <switch name="systems/electric/bus[1]/turn-indicator/I">
            <default value="0"/>
            <test logic="AND" value="0.5">
                systems/gauges/cockpit-turn-indicator/operative == 1
            </test>
        </switch>
        
        <switch name="systems/gauges/cockpit-turn-indicator/display-rad-sec">
            <default value="0"/>
            <test logic="AND" value="systems/gauges/cockpit-turn-indicator/rad-sec">
                systems/gauges/cockpit-turn-indicator/gyro-sensibility GT 0.02
            </test>
        </switch>
        
        <lag_filter name="systems/gauges/cockpit-turn-indicator/rad-sec">
            <input>velocities/r-aero-rad_sec</input>
            <c1>systems/gauges/cockpit-turn-indicator/gyro-sensibility</c1>
        </lag_filter>
        
    </channel>
    
    
    <channel name="Cockpit Voltmeter" execrate="16">
        
        <lag_filter name="systems/gauges/cockpit-voltmeter/display-V">
            <input>systems/electric/bus[1]/V</input>
            <c1>2.0</c1>
        </lag_filter>
        
    </channel>
    
    
    <channel name="Cockpit Amperometer" execrate="16">
        
        <lag_filter name="systems/electric/bus[1]/internal-power-generator-I-display">
            <input>systems/electric/bus[1]/internal-power-generator-I</input>
            <c1>2.0</c1>
        </lag_filter>
        
    </channel>
    
    
    <channel name="Cockpit Jet Temperature" execrate="16">
        
        <lag_filter name="systems/gauges/cockpit-jet-temperature-display-C">
            <input>propulsion/engine/jet-TC-temperature-C</input>
            <c1>0.1</c1>
        </lag_filter>
        
    </channel>
    
    
    <channel name="Cockpit Attitude Indicator J8" execrate="8">
        
        <lead_lag_filter name="systems/gauges/cockpit-attitude-J8-caged-push-position">
            <input>systems/gauges/cockpit-attitude-J8-caged-push-position-status</input>
            <c1>1.0</c1>
            <c2>10.0</c2>
            <c3>1.0</c3>
            <c4>1.0</c4>
            <clipto>
                <min>0.0</min>
                <max>1.0</max>
            </clipto>
        </lead_lag_filter>
        
        <switch name="systems/gauges/cockpit-attitude-J8-caged-push-position-status">
            <default value="systems/gauges/cockpit-attitude-J8-caged-push-position-status"/>
            <test logic="AND" value="0">
                systems/gauges/cockpit-attitude-J8-caged-push-position GT 0.9
            </test>
            <test logic="AND" value="1">
                systems/gauges/cockpit-attitude-J8-caged-push-trigger == 1
            </test>
        </switch>
        
        <lag_filter name="systems/gauges/cockpit-attitude-J8-on-speed">
            <input>systems/gauges/cockpit-attitude-J8-on</input>
            <c1>0.1</c1>
        </lag_filter>
        
        <lag_filter name="systems/gauges/cockpit-attitude-J8-no-flag">
            <input>systems/gauges/cockpit-attitude-J8-no-flag-status</input>
            <c1>2.0</c1>
        </lag_filter>
        
        <switch name="systems/gauges/cockpit-attitude-J8-no-flag-status">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/gauges/cockpit-attitude-J8-on-speed GT 0.5
                systems/gauges/cockpit-attitude-J8-caged-push-position LE 0.05
            </test>
        </switch>
        
        <switch name="systems/gauges/cockpit-attitude-J8-on">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/electric/inv-primary/V GT 110.0
                systems/electric/bus[1]/turn-indicator/fuse == 1
            </test>
        </switch>
        
        <switch name="systems/electric/bus[1]/attitude-indicator/I">
            <default value="0"/>
            <test logic="AND" value="1.0">
                systems/gauges/cockpit-attitude-J8-on == 1
            </test>
        </switch>
        
        <lag_filter name="systems/gauges/cockpit-attitude-roll-deg">
            <input>attitude/phi-deg</input>
            <c1>systems/gauges/cockpit-attitude-J8-on-speed</c1>
        </lag_filter>
        
        <switch name="systems/gauges/cockpit-attitude-roll-deg-caged">
            <default value="systems/gauges/cockpit-attitude-roll-deg-caged"/>
            <test logic="AND" value="attitude/phi-deg">
                systems/gauges/cockpit-attitude-J8-caged-push-position GT 0.95
            </test>
        </switch>
        
        <summer name="systems/gauges/cockpit-attitude-roll-deg-display">
            <input>systems/gauges/cockpit-attitude-roll-deg</input>
            <input>-systems/gauges/cockpit-attitude-roll-deg-caged</input>
        </summer>
        
        <lag_filter name="systems/gauges/cockpit-attitude-pitch-deg">
            <input>attitude/theta-deg</input>
            <c1>systems/gauges/cockpit-attitude-J8-on-speed</c1>
        </lag_filter>
        
        <switch name="systems/gauges/cockpit-attitude-pitch-deg-caged">
            <default value="systems/gauges/cockpit-attitude-pitch-deg-caged"/>
            <test logic="AND" value="attitude/theta-deg">
                systems/gauges/cockpit-attitude-J8-caged-push-position GT 0.95
            </test>
        </switch>
        
        <summer name="systems/gauges/cockpit-attitude-pitch-deg-display">
            <input>systems/gauges/cockpit-attitude-pitch-deg</input>
            <input>-systems/gauges/cockpit-attitude-pitch-deg-caged</input>
        </summer>
        
    </channel>
    
    
    <function name="propulsion/engine/jet-TC-temperature-C">
        <table>
            <independentVar>propulsion/engine/n1</independentVar>
            <tableData>
                0	0
                5	451
                10	516
                20	580
                30	618
                40	645
                50	666
                60	683
                70	698
                80	710
                90	721
                100	731
                110	740
            </tableData>
        </table>
    </function>
    
    
</system>
