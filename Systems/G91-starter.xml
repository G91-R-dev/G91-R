<?xml version="1.0"?>

<!--
Description: G91R2 Canopy automation
-->

<system name="starter">
    
    <property value="0">systems/starter/sw-cover-trigger</property>
    <property value="0">systems/starter/sw-cover-pos</property>
    <property value="0">systems/starter/sw-push-togle</property>
    <property value="0">systems/starter/sw-push-pos</property>
    <property value="0">systems/starter/sw-push-togle-washed</property>
    <property value="0">systems/starter/fuel-shut-off-valve-lock</property>
    <property value="0">systems/starter/fuel-shut-off-valve-lock-pos</property>
    <property value="0">systems/starter/fuel-shut-off-valve</property>
    <property value="0">systems/starter/fuel-shut-off-valve-pos</property>
    <property value="0">systems/starter/fuel-shut-off-valve-on</property>
    <property value="0">systems/starter/fuel-booster-pump</property>
    <property value="0">systems/starter/fuel-booster-pump-pos</property>
    <property value="0">systems/starter/fuel-booster-pump-on</property>
    <property value="0">systems/starter/fuel-booster-pump-on-lag</property>
    <property value="0">systems/starter/HE</property>
    <property value="0">systems/starter/HE-pos</property>
    <property value="0">systems/starter/engine-JPTL</property>
    <property value="0">systems/starter/engine-JPTL-pos</property>
    <property value="0">systems/starter/drop-tank-press</property>
    <property value="0">systems/starter/drop-tank-press-pos</property>
    <property value="0">systems/starter/drop-tank-press-on</property>
    <property value="0">systems/starter/emerg-engine</property>
    <property value="0">systems/starter/emerg-engine-pos</property>
    <property value="0">systems/starter/emerg-engine-on-lg</property>
    <property value="0">systems/starter/emerg-engine-on-lg-transparent</property>
    <property value="0">systems/starter/electric-ok</property>
    
    
    <channel name="starter switch" execrate="8">
        
        <lag_filter name="systems/starter/sw-cover-pos">
            <input>systems/starter/sw-cover-togle-on</input>
            <c1>8.0</c1>
        </lag_filter>
        
        <switch name="systems/starter/sw-cover-togle-on">
            <!--
                "systems/starter/sw-cover-pos LE 0.1" is condition for anti-bounce button in opening phase
                "systems/starter/sw-cover-pos GE 0.9" is condition for anti-bounce button in closing phase
            -->
            <default value="systems/starter/sw-cover-togle-on"/>
            <test logic="AND" value = "1">
                systems/starter/sw-cover-trigger == 1
                systems/starter/sw-cover-togle-on == 0
                systems/starter/sw-cover-pos LE 0.1
            </test>
            <test logic="AND" value = "0">
                systems/starter/sw-cover-trigger == 1
                systems/starter/sw-cover-togle-on == 1
                systems/starter/sw-cover-pos GE 0.9
            </test>
            <test logic="OR" value = "0">
                <test logic="AND">
                    systems/starter/sw-push-togle-washed GE 0.1
                    systems/starter/sw-push-togle-washed LE 0.2
                </test>
                <test logic="AND">
                    systems/starter/sw-push-togle-washed LE -0.1
                    systems/starter/sw-push-togle-washed GE -0.2
                </test>
            </test>
        </switch>
        
        <!-- Starter pusher -->
        
        <washout_filter name="systems/starter/sw-push-togle-washed">
            <input>systems/starter/sw-push-togle</input>
            <c1>1.0</c1>
        </washout_filter>
        
        <switch name="systems/starter/sw-push-togle-norm">
            <default value="1"/>
            <test logic="AND" value = "0">
                systems/starter/sw-push-togle-washed LT 0.6
                systems/starter/sw-push-togle-washed GT -0.6
            </test>
        </switch>
        
        <switch name="systems/starter/sw-push-trigger">
            <default value="systems/starter/sw-push-trigger"/>
            <test logic="AND" value="1">
                systems/starter/sw-push-togle-norm == 1
                systems/starter/sw-push-pos LE 0.05
                systems/starter/sw-push-trigger == 0
            </test>
            <test logic="AND" value="0">
                systems/starter/sw-push-pos GT 0.95
            </test>
        </switch>
        
        <lag_filter name="systems/starter/sw-push-pos">
            <input>systems/starter/sw-push-trigger</input>
            <c1>4.0</c1>
        </lag_filter>
        
        <switch name="systems/starter/sw-push">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/starter/sw-push-pos GT 0.50
            </test>
        </switch>
        
        <!-- Starter rele deleyed -->
        
        <switch name="systems/starter/sw-push-trigger-rele">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/starter/electric-ok == 1
                systems/starter/sw-push-trigger == 1
            </test>
        </switch>
        
        <lag_filter name="systems/starter/sw-push-rele-deleyed">
            <input>systems/starter/sw-push-trigger-rele</input>
            <c1>0.03</c1>
        </lag_filter>
        
        <switch name="systems/starter/sw-push-rele-deleyed-on">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/starter/sw-push-rele-deleyed GT 0.008
            </test>
        </switch>
        
    </channel>
    
    
    <channel name="starter electric" execrate="16">
        
        <switch name="systems/starter/electric-ok">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/electric/bus[1]/V GT 18.0
            </test>
        </switch>
        
        <switch name="systems/electric/bus[1]/starter/I">
            <default value="0"/>
            <test logic="AND" value="6.1">
                systems/starter/sw-push-rele-deleyed-on == 1
            </test>
        </switch>
        
    </channel>
    
    
    <channel name="starter fuel shut off valve" execrate="16">
        
        <lag_filter name="systems/starter/fuel-shut-off-valve-lock-pos">
            <input>systems/starter/fuel-shut-off-valve-lock</input>
            <c1>4.0</c1>
        </lag_filter>
        
        <lag_filter name="systems/starter/fuel-shut-off-valve-pos">
            <input>systems/starter/fuel-shut-off-valve</input>
            <c1>4.0</c1>
        </lag_filter>
        
        <switch name="systems/starter/fuel-shut-off-valve-on">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/starter/fuel-shut-off-valve-pos GT 0.9
                systems/electric/bus[1]/fuel-shut-off/fuse == 1
                systems/electric/bus[1]/V GE 18.0
            </test>
        </switch>
        
    </channel>
    
        
    <channel name="starter fuel booster pump" execrate="16">
        
        <lag_filter name="systems/starter/fuel-booster-pump-pos">
            <input>systems/starter/fuel-booster-pump</input>
            <c1>4.0</c1>
        </lag_filter>
        
        <switch name="systems/starter/fuel-booster-pump-on">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/starter/fuel-booster-pump-pos GT 0.9
                systems/electric/bus[1]/BP-fuel/fuse == 1
                systems/electric/bus[1]/V GE 18.0
            </test>
        </switch>
        
        <switch name="systems/electric/bus[1]/BP-fuel/I">
            <default value="0"/>
            <test logic="AND" value="9">
                systems/starter/fuel-booster-pump-on == 1
            </test>
        </switch>
        
    </channel>
    
    
    <channel name="starter HE" execrate="16">
        
        <lag_filter name="systems/starter/HE-pos">
            <input>systems/starter/HE</input>
            <c1>4.0</c1>
        </lag_filter>
        
        <switch name="systems/starter/HE-on">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/starter/HE-pos GT 0.9
                systems/electric/bus[1]/V GE 16.0
                systems/electric/bus[1]/turbojet-start-up/fuse == 1
            </test>
        </switch>
        
    </channel>
    
    
    <channel name="starter engine JPTL" execrate="16">
        
        <lag_filter name="systems/starter/engine-JPTL-pos">
            <input>systems/starter/engine-JPTL</input>
            <c1>4.0</c1>
        </lag_filter>
        
        <switch name="systems/starter/engine-JPTL-on">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/starter/engine-JPTL-pos GT 0.9
                systems/electric/bus[1]/V GE 18.0
                systems/electric/bus[1]/fuel-JPTL/fuse == 1
            </test>
        </switch>
        
        <switch name="systems/electric/bus[1]/fuel-JPTL/I">
            <default value="0"/>
            <test logic="AND" value="0.6">
                systems/starter/engine-JPTL-on == 1
            </test>
        </switch>
        
    </channel>
    
    
    <channel name="starter engine droppable fuel tabk pressure" execrate="16">
        
        <lag_filter name="systems/starter/drop-tank-press-pos">
            <input>systems/starter/drop-tank-press</input>
            <c1>4.0</c1>
        </lag_filter>
        
        <switch name="systems/starter/drop-tank-press-on">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/starter/drop-tank-press-pos GT 0.9
                systems/electric/bus[1]/V GE 18.0
                systems/electric/bus[1]/drop-tank-press-on/fuse == 1
            </test>
        </switch>
        
        <switch name="systems/electric/bus[1]/drop-tank-press-on/I">
            <default value="0"/>
            <test logic="AND" value="0.5">
                systems/starter/drop-tank-press-on == 1
            </test>
        </switch>
        
    </channel>
    
    
    <channel name="starter emerg engine" execrate="16">
        
        <lag_filter name="systems/starter/emerg-engine-pos">
            <input>systems/starter/emerg-engine</input>
            <c1>4.0</c1>
        </lag_filter>
        
        <switch name="systems/starter/emerg-engine-on">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/starter/emerg-engine-pos GT 0.9
                systems/electric/bus[1]/V GE 18.0
                systems/electric/bus[1]/fuel-AP-emergency/fuse == 1
            </test>
        </switch>
        
        <switch name="systems/electric/bus[1]/fuel-AP-emergency/I">
            <default value="0"/>
            <test logic="AND" value="1">
                systems/starter/emerg-engine-on == 1
            </test>
        </switch>
        
        <switch name="systems/starter/emerg-engine-on-lg">
            <default value="0"/>
            <test logic="AND" value="systems/warning-lights/light-intensity-by-bus1-tension">
                systems/starter/emerg-engine-on == 1
            </test>
        </switch>
        
        <switch name="systems/starter/emerg-engine-on-lg-transparent">
            <default value="0.85"/>
            <test logic="AND" value="systems/warning-lights/transparent-by-bus1-tension">
                systems/starter/emerg-engine-on == 1
            </test>
        </switch>
        
    </channel>
    
    
</system>
