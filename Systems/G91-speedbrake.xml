<?xml version="1.0"?>

<system name="speedbrake">
    
    <!-- per avere l'effetto di limitazione ed allugamento del tempo
    fare un integratore con serbatoio di accumulo in funzione della pressione
    dell'impianto idraulico. In questo modo si ottiene la limitazione dello sforzo, ma anche 
    il rallentamento -->
    
    <property value="1.94">systems/speedbrake/surfice-cmd-sqft</property>
    <property value="0.8">systems/speedbrake/cd_coefficient</property>
    <property value="1.0">systems/speedbrake/position_max</property>
    
    <channel name="Speedbrake control">
        <kinematic name="Speedbrake Control">
            <input>fcs/speedbrake-cmd-norm</input>
            <noscale/>
            <traverse>
                <setting>
                    <position> 0 </position>
                    <time>     0 </time>
                </setting>
                <setting>
                    <position> 1 </position>
                    <time>     3 </time>
                </setting>
            </traverse>
            <output>fcs/speedbrake-pos-norm</output>
        </kinematic>
        
        <switch name="systems/speedbrake/switch_hydraulics_flux">
            <default value="0.0"/>
            <test logic="AND" value="1">
                fcs/speedbrake-cmd-norm GT 0
                systems/speedbrake/position LT 1
            </test>
            <test logic="AND" value="-1">
                fcs/speedbrake-cmd-norm == 0
                systems/speedbrake/position GT 0
            </test>
        </switch>
        
        <pure_gain name="systems/speedbrake/hydraulics_flux">
            <input>systems/hydraulics/flight-system-psi</input>
            <gain>systems/speedbrake/switch_hydraulics_flux</gain>
        </pure_gain>
        
        <integrator name="systems/speedbrake/position">
            <input>systems/speedbrake/hydraulics_flux</input>
            <c1> 0.03 </c1>
            <clipto>
                <min>0.0</min>
                <max>systems/speedbrake/position_max</max>
            </clipto>
        </integrator>        
        
    </channel>
    
    <function name="systems/speedbrake/surfice-cmd-sqft">
        <table>
            <independentVar>fcs/speedbrake-cmd-norm</independentVar>
            <tableData>
                0 0.00
                0.125 0.17
                0.25 0.34
                0.375 0.50
                0.5 0.67
                0.625 0.82
                0.75 0.97
                0.875 1.12
                1 1.25
            </tableData>
        </table>
    </function>
    
</system>

